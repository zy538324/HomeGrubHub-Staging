{% extends "base.html" %}

{% block content %}
<div class="container mt-4">
  <h1>Log a Meal</h1>
  <form id="mealForm" method="POST" action="/nutrition/log-meal" class="mt-3">
    {{ form.hidden_tag() }}
    <div class="mb-3">
      <label for="meal_type" class="form-label">Meal Type:</label>
      <select name="meal_type" id="meal_type" class="form-select">
        <option value="breakfast">Breakfast</option>
        <option value="lunch">Lunch</option>
        <option value="dinner">Dinner</option>
        <option value="snack">Snack</option>
      </select>
    </div>
    <div class="mb-3">
      <label for="meal_date" class="form-label">Date:</label>
      <input type="date" name="meal_date" id="meal_date" value="{{ today }}" class="form-control">
    </div>
    <div class="mb-3">
      <label for="foods" class="form-label">Foods:</label>
      <select name="food_ids" id="foods" multiple class="form-select" data-foods='{{ foods|tojson|safe }}'>
        {% for food in foods %}
        <option value="{{ food.id }}">{{ food.name }} ({{ food.brand }})</option>
        {% endfor %}
      </select>
    </div>
    <button type="submit" class="btn btn-primary">Log Meal</button>
  </form>
  <div id="mealTotals" class="mt-4">
    <h3>Meal Totals</h3>
    <p>Calories: <span id="totalCalories">0</span></p>
    <p>Protein: <span id="totalProtein">0</span></p>
    <p>Carbs: <span id="totalCarbs">0</span></p>
    <p>Fat: <span id="totalFat">0</span></p>
  </div>
</div>
{% endblock %}

{% block scripts %}
<script src="{{ url_for('static', filename='js/nutrition-log-meal.js') }}"></script>
{% endblock %}
